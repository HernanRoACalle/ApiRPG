BEGIN TRANSACTION;
CREATE TABLE [TB_HABILIDADE] (
    [Id] int NOT NULL IDENTITY,
    [Nome] nvarchar(max) NOT NULL,
    [Dano] int NOT NULL,
    CONSTRAINT [PK_TB_HABILIDADE] PRIMARY KEY ([Id])
);

CREATE TABLE [TB_PERSONAGENS_HABILIDADE] (
    [PersonagemId] int NOT NULL,
    [HabilidadeId] int NOT NULL,
    CONSTRAINT [PK_TB_PERSONAGENS_HABILIDADE] PRIMARY KEY ([PersonagemId], [HabilidadeId]),
    CONSTRAINT [FK_TB_PERSONAGENS_HABILIDADE_TB_HABILIDADE_HabilidadeId] FOREIGN KEY ([HabilidadeId]) REFERENCES [TB_HABILIDADE] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_TB_PERSONAGENS_HABILIDADE_TB_PERSONAGENS_PersonagemId] FOREIGN KEY ([PersonagemId]) REFERENCES [TB_PERSONAGENS] ([Id]) ON DELETE CASCADE
);

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Dano', N'Nome') AND [object_id] = OBJECT_ID(N'[TB_HABILIDADE]'))
    SET IDENTITY_INSERT [TB_HABILIDADE] ON;
INSERT INTO [TB_HABILIDADE] ([Id], [Dano], [Nome])
VALUES (1, 39, N'Adormecer'),
(2, 41, N'Congelar'),
(3, 37, N'Hipnotizar');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Dano', N'Nome') AND [object_id] = OBJECT_ID(N'[TB_HABILIDADE]'))
    SET IDENTITY_INSERT [TB_HABILIDADE] OFF;

UPDATE [TB_USUARIOS] SET [PasswordHash] = 0x140C23AF58E8B7F7ACF169E9492E8361AA48E18055190E0F79C659376F57692F720E8D19BAF24F53FAE27AF23F2CD04E7D877F1BA57D3B4A93811CAE88053A9D, [PasswordSalt] = 0xCA1E6040380443045CAAE7C35989ADB304ECC210D08364AEA3DC478141F3B7A831D10200659B65EF3AAE7434499A1C792DE48704E7CF6248C0033AF974DAD406016003DAE9C1158A8844D3EDA58B636A091928AA60BDD56231A26AF1E4E2A4D2A1428D2F2C02CF13AD9DDDB787CF0CD1564FE7C403FDAD1B72B80821C65F6909
WHERE [Id] = 1;
SELECT @@ROWCOUNT;


IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'HabilidadeId', N'PersonagemId') AND [object_id] = OBJECT_ID(N'[TB_PERSONAGENS_HABILIDADE]'))
    SET IDENTITY_INSERT [TB_PERSONAGENS_HABILIDADE] ON;
INSERT INTO [TB_PERSONAGENS_HABILIDADE] ([HabilidadeId], [PersonagemId])
VALUES (1, 1),
(2, 1),
(2, 2),
(2, 3),
(3, 3),
(3, 4),
(1, 5),
(2, 6),
(3, 7);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'HabilidadeId', N'PersonagemId') AND [object_id] = OBJECT_ID(N'[TB_PERSONAGENS_HABILIDADE]'))
    SET IDENTITY_INSERT [TB_PERSONAGENS_HABILIDADE] OFF;

CREATE INDEX [IX_TB_PERSONAGENS_HABILIDADE_HabilidadeId] ON [TB_PERSONAGENS_HABILIDADE] ([HabilidadeId]);

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251001234432_MigracaoMuitosParaMuitos', N'9.0.9');

COMMIT;
GO

